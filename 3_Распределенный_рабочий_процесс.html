<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
  "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
	<title>Git Book - Распределенный рабочий процесс</title>
	<meta http-equiv="content-language" content="en">
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<link rel="icon" href="favicon.png" type="image/png">
	<link rel="stylesheet" href="assets/blueprint/screen.css" type="text/css" media="screen, projection">
  <link rel="stylesheet" href="assets/blueprint/print.css" type="text/css" media="print">
  <!--[if IE]><link rel="stylesheet" href="assets/blueprint/ie.css" type="text/css" media="screen, projection"><![endif]-->
	<link rel="stylesheet" href="assets/stylesheets/mac_classic.css" type="text/css" media="screen, projection">
	<link rel="stylesheet" href="assets/stylesheets/style.css" type="text/css" media="screen, projection">
</head>

<body>
<div class="container chapter showgrids">

  <div class="span-21 header">
    <div class="nav"><a href="3_Сравнение_коммитов_-_git_diff.html">Prev</a>  <a href="3_Таги_git.html">Next</a></div>
    <div class="title"><a href='index.html'>Git Community Book</a></div>
  </div>
  
  <div class="span-21">
    <br/>
  </div>
  
  <div class="span-21">
    <h2>Распределенный рабочий процесс</h2>

<p>Предположим, что Алиса начала новый проект с git репозиторием в директории /home/alice/project, и что Боб, у которого есть своя домашняя директории на той же машине, хочеть помочь с проектом.</p>

<p>Боб начнет работу с:</p>

<pre><code>$ git clone /home/alice/project myrepo
</code></pre>

<p>Это создаст новую директорию "myrepo" содержащую копию репозитория Алисы.
Клон эквивалентен в основании оригиналу проекта, и обладает своей собственной копией истории оригинального проекта.</p>

<p>Затем Боб вносит некоторые изменения и выполняет коммит:</p>

<pre><code>(edit files)
$ git commit -a
(repeat as necessary)
</code></pre>

<p>Когда он готов, он говорит Алисе выполнить pull изменений из репозитория в  /home/bob/myrepo.  Она совершает это выполнив:</p>

<pre><code>$ cd /home/alice/project
$ git pull /home/bob/myrepo master
</code></pre>

<p>Это сливает изменения из ветки "master" Боба в активную ветку Алисы. Если Алиса внесла изменения в свою ветку в тоже самое время, тогда возможно ей придется вручную исправить конфликты если таковые появятся. (Заметьте аргумент "master" в команде выше в действительности не требуется, так как он будет использоваться по умолчанию.)</p>

<p>Команда "pull" таким образом выполняет два действия: она вытягивает изменения из удаленного репозитория, и сливает их в активную ветку.</p>

<p>Когда вы работаете в маленькой группе, это обычная практика работать с одим и тем же репозиторием снова и снова. Определив сокращение 'remote(удаленный)' репозитория вы можете упростить себе работу:</p>

<pre><code>$ git remote add bob /home/bob/myrepo
</code></pre>

<p>С этим Алиса, может выполнять первую операцию одной командой "git fetch" без сливания их в свою ветку:</p>

<pre><code>$ git fetch bob
</code></pre>

<p>В отличие от полной формы, когда Алиса извлекает изменения из удаленного репозитория Боба используя сокращение с помощью <code>git remote</code>, то что было вытянуто, хранится в удаленной отслеживающей ветке, в нашем случае это
<code>bob/master</code>. Так после этого:</p>

<pre><code>$ git log -p master..bob/master
</code></pre>

<p>покажет список всех изменений которые Боб сделал с того времени как он ответвился от ветки "master" Алисы.</p>

<p>После проверки этих изменений, Алиса может слить изменения в свою ветку master:</p>

<pre><code>$ git merge bob/master
</code></pre>

<p>Этот <code>merge</code> может также быть выполнено с помощью 'вытягивания из ее собственной удаленной отслеживаемой ветки', слею.образом:</p>

<pre><code>$ git pull . remotes/bob/master
</code></pre>

<p>Заметьте что команда git pull всегда сливает в активную ветку, не обращая внимания на другие аргументы в командной строке.</p>

<p>Позже Боб, может обновить свой репозиторий включив последние обновления Алисы, выполнив</p>

<pre><code>$ git pull
</code></pre>

<p>Заметьте что ему не требуется указывать путь к репозиторию Алисы; когда Боб клонирует репозиторий Алисы, git хранит местоположение ее репозитория в настройках репозитория, и это расположние используется для извлечения:</p>

<pre><code>$ git config --get remote.origin.url
/home/alice/project
</code></pre>

<p>(Полные настойки созданы командой git-clone. Их можно просмотреть с помощью "git config -l", страница справочника <a href="http://www.kernel.org/pub/software/scm/git/docs/git-config.html">git config</a> описывает значения каждого параметра.)</p>

<p>Git также держит чистую копию ветки "master" Алисы под именем "origin/master":</p>

<pre><code>$ git branch -r
  origin/master
</code></pre>

<p>Ecли Боб позже решит работать с другой машины, он все еще может выполнить клонирование и вытянуть данные используя ssh протокол:</p>

<pre><code>$ git clone alice.org:/home/alice/project myrepo
</code></pre>

<p>Кроме того, у git есть свой родной протокол, или можно использовать rsync или http; просмотрите <a href="http://www.kernel.org/pub/software/scm/git/docs/git-pull.html">git pull</a> чтобы получить больше подробностей.</p>

<p>Git может также быть использован в режиме CVS, центрального репозитория в который различные пользователи добавляют изменения; просмотрите <a href="http://www.kernel.org/pub/software/scm/git/docs/git-push.html">git push</a> и <a href="http://www.kernel.org/pub/software/scm/git/docs/gitcvs-migration.html">gitcvs-migration</a>.</p>

<h3>Публичные git репозитории</h3>

<p>Другой способ передать изменения в проект это попросить мантейнера проекта вытянуть изменения из вашего репозитория используя <a href="http://www.kernel.org/pub/software/scm/git/docs/git-pull.html">git pull</a>. Это способ получить обновления из "main" репозитория, но он хорошо работает и в другом направлении.</p>

<p>Если вы и мантейнер оба имеете учетные записи на одной машине, тогда вы можете просто вытянуть изменения из репозиториев друг друга напрямую; команды которые принимают URLы репозиториев как аргумент также примут имя локальной директории:</p>

<pre><code>$ git clone /path/to/repository
$ git pull /path/to/other/repository
</code></pre>

<p>или ssh URL:</p>

<pre><code>$ git clone ssh://yourhost/~you/repository
</code></pre>

<p>Для проектов с малым количеством разработчиков, или для синхронизации нескольких частных репозиториев, это именно то что вам нужно.</p>

<p>Как бы так ни было, более общий способ сделать это открыть отдельный публичный репозиторий (обычно на отдельной машине) для других, из которого они могли бы вытягивать изменения. Обычно это более удобный способ, и он позволяет вам отделить личную работу от публичной ее части.</p>

<p>Вы продолжите делать вашу обычную работу в вашем личном репозитории, но периодически будете вставлять изменения из вашего личного репозитория в ваш публичный репозиторий, позволяя другим разработчикам вытягивать из этого репозитория. Так поток изменений, в ситуации где есть один разработчик с публичным репозиторием, выглядит так:</p>

<pre><code>                        you push
  your personal repo ------------------&gt; your public repo
    ^                                     |
    |                                     |
    | you pull                            | they pull
    |                                     |
    |                                     |
        |               they push             V
  their public repo &lt;------------------- their repo
</code></pre>

<h3>Внесение изменений в публичный репозиторий</h3>

<p>Заметьте что экспорт через http или git позволяет другим мантейнерам получать ваши изменения, но у них нет доступа на запись. Для этого вам нужно обновить публичный репозиторий и включить туда последние обновления созданные в вашем частном репозитории.</p>

<p>Простейший способ сделать это - использовать <a href="http://www.kernel.org/pub/software/scm/git/docs/git-push.html">git push</a> и ssh; чтобы обновить удаленную ветку по имени "master" с последним состоянием вашей ветки под именем "master", выполните</p>

<pre><code>$ git push ssh://yourserver.com/~you/proj.git master:master
</code></pre>

<p>или просто</p>

<pre><code>$ git push ssh://yourserver.com/~you/proj.git master
</code></pre>

<p>Как и с git-fetch, git-push будет жаловаться если это не результат fast forward; просмотрите след.секцию чтобы узнать как решить эту проблему.</p>

<p>Заметьте что цель "push" обычно пустой репозиторий. Вы также можете выполнить push в репозиторий который имеет извлеченное рабочее дерево, но рабочее дерево не обновится выполнением push. Этот способ ведет к неопределенным результатам если ветка в которую вы выполняете push - активная извлеченная ветка!</p>

<p>Также как и с git-fetch, вы возможно также установите параметры конфигурации для безопасной печати; так например после</p>

<pre><code>$ cat &gt;&gt;.git/config &lt;&lt;EOF
[remote "public-repo"]
    url = ssh://yourserver.com/~you/proj.git
EOF
</code></pre>

<p>вы должны быть способны выполнить push выше след.образом</p>

<pre><code>$ git push public-repo master
</code></pre>

<p>Просмотрите объяснение remote.<name>.url, branch.<name>.remote,
and remote.<name>.push параметры в <a href="http://www.kernel.org/pub/software/scm/git/docs/git-config.html">git config</a> для получения подробностей.</p>

<h3>Что делать если выполнение push завершилось неудачей</h3>

<p>Если результат выполнения push не будет fast-forward удаленной ветки, то ошибка будет выглядеть так:</p>

<pre><code>error: remote 'refs/heads/master' is not an ancestor of
local  'refs/heads/master'.
Maybe you are not up-to-date and need to pull first?
error: failed to push to 'ssh://yourserver.com/~you/proj.git'
</code></pre>

<p>Это может случиться, например если вы:</p>

<pre><code>- использовали `git-reset --hard` чтобы удалить уже опубликованные коммиты или
- использовали `git-commit --amend` чтобы заменить уже опубликованные коммиты или
- использовали `git-rebase` чтобы переопределить любой уже опубликованный коммиты.
</code></pre>

<p>Вы также можете заставить git-push выполнить обновление в любом случае если перед именем ветки поставите символ плюс:</p>

<pre><code>$ git push ssh://yourserver.com/~you/proj.git +master
</code></pre>

<p>Обычно всякий раз когда голова ветки в публичном репозитории модифицируется, оно модифицируется так чтобы указывать на потомка коммита на который она указывало до этого. Принуждая выполнение push в такой ситуации, вы нарушаете это соглашение.</p>

<p>Тем не менее, это общая практика для разработчиков которым нужен простой способ опубликовать серию патчей, и это допустимый компромис пока другие разработчики предупреждены каким образом вы намереваетесь управлять веткой.</p>

<p>Также возможны такие ситуации когда push завершается неудачно в случае если другие разработчики имеют права на выполнение push в тот же репозиторий. В этом случае правильное решение - это повторить push после первого обновления вашей работы или выполнив pull или выполнив fetch с последующим rebase.; Просмотрите след. секцию и <a href="http://www.kernel.org/pub/software/scm/git/docs/gitcvs-migration.html">gitcvs-migration</a> чтобы получить больше подробностей.</p>

<p><a href="" title="GitCast #8: Distributed Workflow">gitcast:c8-dist-workflow</a></p>


  </div>
  
  <div class="span-21">
    <hr/>
    <div class="center"><a href="3_Сравнение_коммитов_-_git_diff.html">Prev</a>  <a href="3_Таги_git.html">Next</a></div>
    <hr/>
  </div>
  
  <div class="span-17 footer">
  	<div class="menu">
  		This book is maintained by Scott Chacon, and hosting is donated by GitHub.
  		<br>
  		Please email me at <a href="mailto:schacon@gmail.com">schacon@gmail.com</a>
  		with patches, suggestions and comments.
	  </div>
  </div>
  <div class="span-4 last center">
    <a href="http://github.com"><img src="assets/images/github.png" alt="github logo"></a>
  </div>
  
</div>

<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-82337-12");
pageTracker._initData();
pageTracker._trackPageview();
</script>
<script src="http://static.getclicky.com/40584.js" type="text/javascript"></script>
<noscript><p><img alt="Clicky" src="http://in.getclicky.com/40584-db6.gif" /></p></noscript>

</body>
</html>
