<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
  "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
	<title>Git Book - Управление ветвлением и слиянием</title>
	<meta http-equiv="content-language" content="en">
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<link rel="icon" href="favicon.png" type="image/png">
	<link rel="stylesheet" href="assets/blueprint/screen.css" type="text/css" media="screen, projection">
  <link rel="stylesheet" href="assets/blueprint/print.css" type="text/css" media="print">
  <!--[if IE]><link rel="stylesheet" href="assets/blueprint/ie.css" type="text/css" media="screen, projection"><![endif]-->
	<link rel="stylesheet" href="assets/stylesheets/mac_classic.css" type="text/css" media="screen, projection">
	<link rel="stylesheet" href="assets/stylesheets/style.css" type="text/css" media="screen, projection">
</head>

<body>
<div class="container chapter showgrids">

  <div class="span-21 header">
    <div class="nav"><a href="3_Обычный_рабочий_процесс.html">Prev</a>  <a href="3_Просмотр_истории_-_git_log.html">Next</a></div>
    <div class="title"><a href='index.html'>Git Community Book</a></div>
  </div>
  
  <div class="span-21">
    <br/>
  </div>
  
  <div class="span-21">
    <h2>Управление ветвлением и слиянием</h2>

<p>Один git репозиторий может заключать в себе множество ветвей разработки. Чтобы создать новое ответвление под именем "experimental", выполните команду</p>

<pre><code>$ git branch experimental
</code></pre>

<p>Теперь если вы выполните</p>

<pre><code>$ git branch
</code></pre>

<p>то получите список всех существующих ветвей:</p>

<pre><code>  experimental
* master
</code></pre>

<p>Ветка "experimental" это та, которую вы только что создали, а ветка "master" это ветка по умолчанию которая создается автоматически. Звездочка указывает в какой ветке вы в данный момент находитесь; наберите</p>

<pre><code>$ git checkout experimental
</code></pre>

<p>чтобы переключиться в ветку experimental. Теперь отредактируйте файл, выполните комит, и переключитесь обратно в главную ветку "master":</p>

<pre><code>(edit file)
$ git commit -a
$ git checkout master
</code></pre>

<p>Убедитесь, что сделанные изменения невидимы, поскольку они были сделаны в ветке experimental, а вы сейчас в главной ветке "master".</p>

<p>Вы можете сделать другое изменение в ветке "master", затем выполнить коммит:</p>

<pre><code>(edit file)
$ git commit -a
</code></pre>

<p>на этом этапе две ветки разошлись, поскольку в каждой из них различные изменения. Чтобы включить изменения в ветке experimental в master, выполните</p>

<pre><code>$ git merge experimental
</code></pre>

<p>Если изменения не конфликтуют, то вы закончили. Если же существуют какие либо конфликты, то в проблемных файлах останутся заметки которые можно увидеть выполнив;</p>

<pre><code>$ git diff
</code></pre>

<p>Как только вы отредактировали файлы вызывающие конфликты выполните,</p>

<pre><code>$ git commit -a
</code></pre>

<p>это выполнит коммит результат слияния. В заключении,</p>

<pre><code>$ gitk
</code></pre>

<p>покажет наглядное графическое представление истории.</p>

<p>Теперь вы можете удалить ветку experimental командой</p>

<pre><code>$ git branch -d experimental
</code></pre>

<p>Эта команда гарантирует что изменения в ветке experimental уже в текущей активной ветке.(Прим. переводчика: если вы попытаетесь удалить ветку которую вы не слили со своей рабочей git выведет предупреждение и попросит вас выполнить след.команду $ git branch -D experimental)</p>

<p>Если вы отрабатываете в ветке сумашедшие идеи, и уже пожалели об этой ветке, вы всегла можете удалить ветку выполнив</p>

<pre><code>$ git branch -D crazy-idea
</code></pre>

<p>Ветки это легко и просто, и это хороший способ попробовать что то новое.</p>

<h3>Как сливать ветки</h3>

<p>Вы можете объединить две разошедшиеся ветки разработки используя
<a href="http://www.kernel.org/pub/software/scm/git/docs/git-merge.html">git merge</a>:</p>

<pre><code>$ git merge branchname
</code></pre>

<p>сливает изменения сделанные в ветке "branchname" в активную(рабочую) ветку.  Если присутствуют конфликты -- например один и тот же файл модифицирован разными способами в удаленной и локальной ветках -- то вы будете предупреждены; вывод будет выглядеть след. образом:</p>

<pre><code>$ git merge next
 100% (4/4) done
Auto-merged file.txt
CONFLICT (content): Merge conflict in file.txt
Automatic merge failed; fix conflicts and then commit the result.
</code></pre>

<p>Отметки конфликтов останутся в проблемных файлах, и после того как вы исправите их вручную, вы можете обновить индекс и выполнить git commit, как вы обычно это делаете когда изменяете файл.</p>

<p>Если вы просмотрите результирующий коммит используя gitk, вы увидите что у него два родителя: один указывает на последний коммит активной ветки, а другой на последний коммит другой ветки.</p>

<h3>Исправление конфликтов при слиянии</h3>

<p>Когда слияние не происходит автоматически, git оставляет индекс и рабочее дерево в особом состоянии которое дает всю информацию необходимую чтобы разрешить конфликт.</p>

<p>Файлы с конфликтами отмечаются в индексе особым образом, так что до тех пор пока вы не исправите проблему и не обновите индекс, выполненить <a href="http://www.kernel.org/pub/software/scm/git/docs/git-commit.html">git commit</a> не удастся:</p>

<pre><code>$ git commit
file.txt: needs merge
</code></pre>

<p>Также, <a href="http://www.kernel.org/pub/software/scm/git/docs/git-status.html">git status</a> перечислит эти файлы как "unmerged", а файлы с конфликтами будут иметь добавленные отметки, и выглядеть след.образом:</p>

<pre><code>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD:file.txt
Hello world
=======
Goodbye
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 77976da35a11db4580b80ae27e8d65caf5208086:file.txt
</code></pre>

<p>Все что вам нужно это отредактировать файлы, исправить конфликты, а затем выполнить</p>

<pre><code>$ git add file.txt
$ git commit
</code></pre>

<p>Заметьте что сообщение-описание коммита уже будет содержить некоторую информацию о слиянии. Обычно вы можете оставить это сообщение-описание, а также можете добавить свои дополнительные комментарии, если пожелаете.</p>

<p>Теперь вы знаете все что вам нужно чтобы выполнить простое слияние. Но git  предоставляет больше информации, чтобы помочь разрешить конфликты:</p>

<h3>Отменить слияние</h3>

<p>Если в процессе слияния и исправления конфликтов,вы застряли и решили сдаться и выбросить все к черту, то вы всегда можете вернуться с состоянию pre-merge (такое же как и было до того как вы запустили слияние) выполнив</p>

<pre><code>$ git reset --hard HEAD
</code></pre>

<p>Если вы уже выполнили коммит после слияния, и вы хотите сбросить его,</p>

<pre><code>$ git reset --hard ORIG_HEAD
</code></pre>

<p>Как бы там ни было, последняя команда может быть опасной в некоторых случаях --никогда не сбрасывайте коммит если этот коммит возможно уже был использован в слиянии в другую ветку, если вы это сделаете то это запутает последующие слияния.</p>

<h3>fast-forwarding слияния</h3>

<p>Есть один специальный случай не упомянутый выше, который несколько иной по сути. Обычно, результаты слияния это коммит у которого два родителя, один на каждую ветку разработки.</p>

<p>Однако в некоторых случаях когда активная ветка не отклонилась от другой -- и  каждый коммит в активной ветке уже содержится в другой -- то git просто выполняет "fast forward"; голова активной ветки перемещается вперед и указывается на голову сливаемой ветки, без создания каких-либо новых коммитов.</p>

<p><a href="" title="GitCast #6: Branching and Merging">gitcast:c6-branch-merge</a></p>


  </div>
  
  <div class="span-21">
    <hr/>
    <div class="center"><a href="3_Обычный_рабочий_процесс.html">Prev</a>  <a href="3_Просмотр_истории_-_git_log.html">Next</a></div>
    <hr/>
  </div>
  
  <div class="span-17 footer">
  	<div class="menu">
  		This book is maintained by Scott Chacon, and hosting is donated by GitHub.
  		<br>
  		Please email me at <a href="mailto:schacon@gmail.com">schacon@gmail.com</a>
  		with patches, suggestions and comments.
	  </div>
  </div>
  <div class="span-4 last center">
    <a href="http://github.com"><img src="assets/images/github.png" alt="github logo"></a>
  </div>
  
</div>

<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-82337-12");
pageTracker._initData();
pageTracker._trackPageview();
</script>
<script src="http://static.getclicky.com/40584.js" type="text/javascript"></script>
<noscript><p><img alt="Clicky" src="http://in.getclicky.com/40584-db6.gif" /></p></noscript>

</body>
</html>
